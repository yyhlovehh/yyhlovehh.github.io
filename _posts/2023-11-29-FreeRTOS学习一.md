# FreeRTOS学习一

## 1、任务创建

**常用动态创建任务，比较方便。**

![4](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291725014.png)

![1](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291333303.png)

![2](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291335681.png)

![3](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291338186.png)

![5](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291909007.png)



**任务调度本质上是使用中断进行的，而使用临界区保护，就是保护那些不想被打断的程序段。**

## 2、任务挂起和恢复

![2_1](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291914905.png)

![2_2](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291915188.png)

![2_3](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291917147.png)

![2_4](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311291918002.png)

pdTRUE:恢复的任务优先级大于当前正在执行的任务；

pdFALSE:不需要进行任务切换。

**中断优先级范围：5~15。中断优先级越小越高。**

## 3、中断管理系统

![3_1](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292206331.png)

![3_2](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292211073.png)

![3_3](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292212284.png)

![3_4](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292214141.png)

![3_5](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292215657.png)

PendSV:用于任务切换、调度；

SysTick

![3_6](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292220672.png)

![3_7](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292222492.png)

![3_8](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292226415.png)

**关中断函数：portDISABLE_INTERRUPTS()**

![3_9](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292228607.png)

## 4.临界段代码保护与任务调度器的挂起和恢复

注意只针对FreeRTOS的5~15级中断，0~4级中断仍然响应。（关中断）

![4_1](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292302356.png)

![4_2](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292303356.png)

支持嵌套！！！

![4_3](https://raw.githubusercontent.com/yyhlovehh/yyhlovehh.github.io/master/202311292305371.png)